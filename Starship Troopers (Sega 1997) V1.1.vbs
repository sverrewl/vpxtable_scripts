'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNKkl'.  .lNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWWMXxc;..      .kMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOdl:xWk.           dWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWX0kxKMMMMMMMMMMMMMMMMMMMMMMMMMWNKOdOWK:    lWx.    ,,     dWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWN0koc;.. .dMMMMMMMMMMMMMMMMMMMMNK0XNd'.  cN0'    oWd.   .Ok.   .xMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKkdc;..       .dMMMMMMMMMMMMMMMMMXd:'..xK,    lWO.    dWd    '0k.   .kMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKkdc;..             .dMMMMMMMMWXK00KNMMk.   .x0'    oWO.   .xWo    ,0x.   .OMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKkdl;'.               .,:okXMMMWNKxc,.....:0Wx.   .kO.    dWk.   .kNl    ,Kd    .OMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKOdc;'.               .':lxOKNWWMMMNk:'.         lNd.   .OO.   .dWx.   .kNc    ;Ko    '0MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKOdl;'.               .':lxOKXKOxl:;,;dNNo.    .;,     lNo    '0k.   .xWd.   .OX:    :Xl    ,KMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKOdl:'.               .':ldOKNWMKd:,.       .xO.     ,0o     oNl    ,Kx.   .kWo    '0X;    cXc    ;KMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNKOxl:'.               .';ldOKNXKkxKMMWd           .dx.     ,0l    .xNc    .l,    .OWl    ,KK,    ;l.    :XMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNXOxl:'.               .';ldOKXNWXxl;'. .oWMWo    .dl    .xx.     ;0d,;ldONN:           '0Nc    ,K0'          .kWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWX0xo:,.               .';cdOKXNKOdl:;kx.      lWMWl    ,Kx.   .kd.     :XNNWMMMMX:           '0N:    ;X0'        .:OWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMWKko:,.               ..;cdkKXNKOxl:'.    .dl       cNMNc    ;Kd    .Od      :NWXKOOXWK;    ,x:    ,KX;    :NO.    .:oxKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMNO:.              ..;cdkKNWMMNx:'.        .'lk:       :NMN:    ;Ko    'Oo      .:;..  ,0K,    lXc    ;XK;    cNk.   .xWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMKc.          ..;cok0NWMMMMMMMM0'         ;kKNW0'       ;XMX;    :Xl    ;0l             .k0'    oX:    :XK,    lWx.   .kMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKOkk0X
'MMMMMMMMMMMMMMMMMMMMMMK:         'lk0XWMMMMMMMMMMMMMM0;';l:.    oWMMMk.   .   ,KMK,    ,l.   'kNk,..',:lc.    .OO.    dK;    cN0'    oWx.   .OMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOo:'.    '
'MMMMMMMMMMMMMMMMMMMMMNl         'OMMMMMMMMMMMMMMMMMMMWXNWMO.   .dWMMWo   ..   '0M0'          ;OWWNXXNWMMK,    '0O.   .xK,    cNO.    dWd    '0MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNNWMMMNx,.      ''    
'MMMMMMMMMMMMMMMMMMMMMk.         :NMMMMMMMMMMMMMMMMMMMMMMMMk.   .xMMMNc   ''   '0M0'           cNMMMMWNXW0'    '0k.   .x0'    lWk.   .xWd'':oONMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWX0xo:,''cOWXl    .c,    ' 
'MMMMMMMMMMMMMMMMMMMMWl          lWMMMMMMMMMMMMMMWXK00XWMMMx.   .kMMMK,   ;;   .OMO.    :o.    cNKxl:;,,kO'    ,Kx.   .kO.    oWk. .'c0WX00OdxXMMMMMMMMMMMMMMMMMMMMMMMMMWNXWNx:,..       :Xk.    ;0c     
'MMMMMMMMMMMMMMMMMMMMK;          oWMMMMMMMMWX0koc,.. ..;OWMx.   .kMMMO.   c:   .kMk.   .x0'    lXl     .kO.    ,Kd.   .OO.   .kWKkkOOOdl:'.  '0MMMMMMMMMMMMMMMMMMMWNKOdl:',O0'           ;Kd     :0:    '
'MMMMMMMMMMMMMMMMMMMM0'         .xMMMWX0koc,..          'OWd    .OMMMd.  .oc   .xMx.   .kO'    oX:     .kk.    :Xo    ,00lldk00Oxl:'.        '0MMMMMMMMMMMMMWWMMMNo'.     .OO.    cx'    :Kl     lKo:ldOK
'MMMMMMMMMMMMMMMMMMMMk.          ;doc;..                 oNo    '0MMNl   .x:   .dWx.   .OO.    dX:     .c:    'OWd,;ldOXKOxl:'.              '0MMMMMMMNKOdl:;:oKMK,    .,:dXO.   .xK,    cKc     oWWWMMMM
'MMMMMMMMMMMMMMMMMMMMx.                                  lXl    ,KMMX;    ..    oWd    .Ok.   .xX;          'oKWWX0Oxo:,.                 ..;dXMMMW0o:,.       cN0'    lNMMMk.   .x0'    lK:    .dNX0kxkK
'MMMMMMMMMMMMMMMMMMMWo                                   lXc    ;KMM0'          lNo    '0x.   .xWx,.....,:ok0Oxo:,.                 ..;coddddookXMX:           ,KO.    dWMMMx.   .k0'    oK;     .,..   :
'MMMMMMMMMMMMMMMMMMMNc                                   oX:    :XMMx.   .,.    cXl    ,Kx.   ,OMMNK0Okxdoc,..                ..;cokKX0d:'.     cXX;    .;.    ,Kk.   .xMMMWd    .OO.   .x0,            ;
'MMMMMMMMMMMMMMMMMMMX;                                  .xX;    :NMWo   .dXc    :Kc    ;XOccdk0K0koc,'..                ..;coxOKNMMMXo.         '0K,    lK:    ;Xk.   .xWNNWo    .c;   .lXXo'',:ld:     :
'MMMMMMMMMMMMMMMMMMMK,                                  .kK,    cNMX:   .kNc    ;0l';cd0NX0koc,..                 ..,cokOkxoc;,';kWWd.   .:'    '0K,    oK;    :Xx.    ,:,oXl          .oXMWNNWMMWd     l
'MMMMMMMMMMMMMMMMMMMK,                                  '0K,    lWM0'   '0Nc..':xXX0Okoc;..                 ..,cox0XWMXd,.       '0X;    cXl    '00'    dK;    cNd        lXc           .OMMMMNXXNo     o
'MMMMMMMMMMMMMMMMMMMX;                 .,:oxd'          ,K0'    oWMk.  .lXWKOOOkoc;..                  .,:oxkOkxdxKWMK;          .k0'    lXc    ,KO.   .xK,    lNo     .,cOX:    'd:    .ONkl:'.cKl    .d
'MMMMMMMMMMMMMMMMMMMWd.          .,:ox0XWMMMNl          :XO.   .dWM0odkOOkdc;..                    'dkOOkxl:'.    .xNo    'xc    .OO'    oX:    ;Xk.   .x0'    oNl    'kNMMX;    :Xl    '0k.    cK:    .k
'MMMMMMMMMMMMMMMMMMMMNx,....':lxOXWMMMMMMMMMN:          lNO,.;lxKNKkdl;'.                          lWMO,           lK:    :Xl    '0O.    dK;    :Xk.   .k0'    dNc    ,KMMMK,    cXc    ,0x.    lK;    '0
'MMMMMMMMMMMMMMMMMMMMMWNXKKXNMMMMMMMMMMMMMMMX;          dWN0Okdl;'.                 .':;.          oWMx.    ,,     l0,    cXc    ,Kk.   .xK,    cNx.   .OO.   .dX:    ;XMMM0'    lX:    ,Ko     ,:.   .xW
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM0'         .kM0:.                 .':ldOKNWO.         .xWWd.   .kO.    o0'    lXc    ,Kx.   .x0'    lNd.   .l:    .kX;    :XMMM0'    oK;    ;Ko        .'oKWM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMO.         :XMk.            .':ldOKNMMMMMMMk.         .xWWo    .Ok.   .dO'    oK:    ;Xd.   .kO.    oNo           :XK,    cNMMMO.    dK;    :X0:...';cd0NMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNl         .kMMk.      .';ldOKNWMMMMMMMMMMMMx.         .kWNl    '0k.   .xO.    dK;    :Xd    .OO.    dNl         .oXM0'    lXXKWk.   .xK,   .oNMWNXXNWMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKkd;.        .dWMMO'.';ldOKNWMMMMMMMMMMMMMMMMMMd.         .ONXc    ,Kx.   .kk.   .xK,    cXo    '0k.   .xNc     'cokXWMM0'    .'.;Kx.   .kXocdk0NMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKOdl;'.           'kWMMMN0KNWMMMMMMMMMMMMMMMMMMMMMMMWo          '0NK:    ,Ol    ;Kx.   .k0'    lXl    '0x.   .kNc    ;KMMMMMMMO.       ,Kk,,coONMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMWNKOdl;'.              .,dXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWl          ,KXO:    ..    ,OWd.   .k0'    oXc    ,Kd.   .kX:    :NMMMMMMMk.   .';lONWNWMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMWNKOdl:'.               .':lx0NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNc          ;XXk;           cXd    .OO.    dX:    ;Kd    .OX;    cNMMMMMMM0lldOKNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMNXOxl:'.               .':ldOKNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN:          :XKx,    .,.    ,0o    '0k.   .xK;    ;O:    ,KK,    lWMMMMMMMWWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMWNXOxo:'.               .':ldOKNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMX;          cN0o'    lK:    ;0l    '0x.   .kK,     .    .xWK:.,cdKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMWX0xo:,.               .';ldOKNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMK,          lWOc.    dK;    :0c    ,Kd.   .OX;        .:OWMWXXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'o:,.               ..;cdkKNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM0,          oWk:.   .dK,    c0:    .l,    ;KWx,..';cokXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'             ..;cdkKNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM0'         .dWk,.   .x0'    lK;          ,OWMWNXXNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'.      ..;cok0NWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMO.         .xWx'.   .k0'    oXl      .'ckXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
''..,cok0XWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMk.         .kWd.    .OO.    oWXdccldkKNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'00XWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMx.         .OWo.    '0k...;lKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWd.         '0Wl.  ..lXX0KNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWo          ,0WOodk0NWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWl          ;KMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNc          ;XMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMX:          cNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMX;          lNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMK,          oWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM0'          dWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMO.         'kMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMk.   .,:lx0XWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
'MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMk'.:x0NWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM


' Starship Troopers (1997) Sega Pinball by eMBee/Sixtoe for VPX (Version 1.1)


'Thanks to Destruk, TAB, TheManFromPost for VP8/9 version and DeVaL for the VPX conversion.


'Changelog:
'V1.0: 'Script changes, new mechanical sounds, Adjusted ramps, new plastics, new lighting, new playfield, new apron, new materials en textures.
'V1.1; Added Global lite to Live fire range, fixed analog/mechanical plunger, Moved couple of walls, changed Arachnid primivtive size and texture, cleanups

'Special Thanks to:
'Sixtoe: Playfield upgrades, lights and improvements and lots of support and fixes.
'Thalamus: Improved directional sounds, support and fixes
'32Assassin: Assets from his SST base table.
'JPSalas: GI , lighting and overall appearance 
'Vogliadicane: Upscaled plastics and images.
'Knorr: 3D Apron
'Schreibi34: PF Inserts
'Flupper: Dome and material textures
'Zany/Dark: Domes


'Thanks to all authors which have helped directly or via threath support and tutorials


'All Logos, Copyrights and Trademarks are property of their respective owners.


Option Explicit
Randomize

On Error Resume Next
ExecuteGlobal GetTextFile("controller.vbs")
If Err Then MsgBox "You need the Controller.vbs file in order to run this table (installed with the VPX package in the scripts folder)"
On Error Goto 0

Const cGameName="startrp",UseSolenoids=2,UseLamps=1,UseGI=1,UseSync=1
Const SSolenoidOn="SolOn",SSolenoidOff="SolOff",SFlipperOn="FlipperUp",SFlipperOff="FlipperDown",SCoin="Coin3"

LoadVPM "01530000","sega.vbs",3.1


Randomize
Dim luts, lutpos

'******************************************************
' 						OPTIONS (not working yet)
'******************************************************

'luts = array("LUT_dark", "LUT_darker", "LUT_daylight", "LUT_night", "LUT_pitch-dark")
'lutpos = 5							'  set the nr of the LUT you want to use (0 = first in the list above, 1 = second, etc); 5 is the default
'Const EnablelEFTMagnasave = 1		' 1 - on; 0 - off; if on then the LEFT magnasave button let's you rotate all LUT's

' Options
' Volume devided by - lower gets higher sound

Const VolDiv = 2000    ' Lower number, louder ballrolling/collition sound
Const VolCol = 10      ' Ball collition divider ( voldiv/volcol )

' The rest of the values are multipliers
'
'  .5 = lower volume
' 1.5 = higher volume

Const VolBump   = 3    ' Bumpers volume.
Const VolRol    = 1    ' Rollovers volume.
Const VolGates  = 1    ' Gates volume.
Const VolMetal  = 1    ' Metals volume.
Const VolRB     = 1    ' Rubber bands volume.
Const VolRH     = 1    ' Rubber hits volume.
Const VolPo     = 1    ' Rubber posts volume.
Const VolPi     = 1    ' Rubber pins volume.
Const VolPlast  = 1    ' Plastics volume.
Const VolTarg   = 1    ' Targets volume.
Const VolWood   = 1    ' Woods volume.
Const VolKick   = 1    ' Kicker volume.
Const VolSpin   = 1.5  ' Spinners volume.
Const VolFlip   = 3    ' Flipper volume.
Const VolFlipH  = 1    ' Flipper Hit volume.
Const VolDrain  = 1    ' Drain volume.
Const VolGI     = 1    ' General Illumination volume.


SolCallBack(1)="bsTrough.SolOut"
SolCallBack(2)="vpmSolAutoPlungeS Plunger1,SoundFX(""SolOn"",DOFContactors),5,"
SolCallBack(3)="bsBottom.SolOut"
SolCallBack(4)="bsTop.SolOut"
SolCallback(5)="LMag.MagnetOn="
SolCallback(6)="RMag.MagnetOn="
SolCallBack(7)="SolBrainBug"
SolCallBack(8)="vpmSolSound SoundFX(""Knocker"",DOFKnocker)," 'dispenser - Set adjustment to OFF to get knocker sound
SolCallBack(9)="vpmSolSound SoundFX(""fx_bumper1"",DOFContactors),"
SolCallBack(10)="vpmSolSound SoundFX(""fx_bumper2"",DOFContactors),"
SolCallBack(11)="vpmSolSound SoundFX(""fx_bumper3"",DOFContactors),"
SolCallBack(12)="vpmSolSound SoundFX(""Sling"",DOFContactors),"
SolCallBack(13)="vpmSolSound SoundFX(""Sling"",DOFContactors),"
'SolCallBack(14)="vpmSolFlipper Flipper1,Nothing,"
SolCallback(14) = "SolMiniFlipper"
SolCallback(17)="SolMotorOn"
SolCallBack(23)="SolBrainFlash"
'SolCallBack(24)='optional coil
SolCallBack(25)="Sol25"     'red x 4
SolCallBack(26)="Sol26"     'yellow x 4
SolCallBack(27)="Sol27"     'green x 4
SolCallBack(28)="Sol28"     'blue x 4
SolCallBack(29)="SolWarrior"        'flash multiball x 4
SolCallBack(30)="vpmFlasher Array(F30A,F30B,F30C,F30D),"     'left ramp x 4
SolCallBack(31)="vpmFlasher Array(F31A,F31B,F31C,F31D),"     'right ramp x 4
SolCallBack(32)="vpmFlasher Array(F32A,F32B),"        'pops x 2
SolCallBack(33)="vpmFlasher Array(L28,L29,L30),"
'SolCallBack(sLLFlipper)="vpmSolFlipper LeftFlipper,Nothing,"
'SolCallBack(sLRFlipper)="vpmSolFlipper RightFlipper,Nothing,"

SolCallback(sLRFlipper) = "SolRFlipper"
SolCallback(sLLFlipper) = "SolLFlipper"

Sub SolLFlipper(Enabled)
	If Enabled Then
		PlaySound SoundFX("FlipperUp",DOFFlippers)
		LeftFlipper.RotateToEnd
   Else
		PlaySound SoundFX("FlipperDown",DOFFlippers)
		LeftFlipper.RotateToStart
   End If
End Sub

Sub SolRFlipper(Enabled)
   If Enabled Then
		PlaySound SoundFX("FlipperUp",DOFFlippers)
		RightFlipper.RotateToEnd
   Else
		PlaySound SoundFX("FlipperDown",DOFFlippers)
		RightFlipper.RotateToStart
   End If
End Sub

Sub SolMiniFlipper(Enabled)
	If Enabled Then
		PlaySound SoundFX("FlipperUp",DOFFlippers)
		Flipper1.RotateToEnd
	Else
		PlaySound SoundFX("FlipperDown",DOFFlippers)
		Flipper1.RotateToStart
	End If
End Sub
	
	
Sub AutoPlunger(Enabled)
	If Enabled Then
		PlungerIM.AutoFire
	End If
End Sub


'Stern-Sega GI 
set GICallback = GetRef("UpdateGI")
Sub UpdateGI(no, Enabled)
'		SetLamp 134, Enabled	'Backwall bulbs
	If Enabled Then
		Dim xx
		For each xx in GI:xx.State = 1:Next
		DOF 101, DOFOn
		PlaySound "fx_relay"
	Else
		For each xx in GI:xx.State = 0:Next
		DOF 101, DOFOff
		PlaySound "fx_relay"
	End If
End Sub

Dim BugLit
BugLit=False

Sub SolWarrior(Enabled)
  If Enabled Then
    BugLit=True
    BugWalls(Position).IsDropped=1
    BugTargets(Position).IsDropped=1
    Position=Position+6
    BugWalls(Position).IsDropped=0
    BugTargets(Position).IsDropped=0
    BugWarSledPrim.TransY = -16
	PlaySoundAtVol "fx_chapa", BugWarSledPrim, 1
  Else
    BugLit=False
    BugWalls(Position).IsDropped=1
    BugTargets(Position).IsDropped=1
    Position=Position-6
    BugWalls(Position).IsDropped=0
    BugTargets(Position).IsDropped=0
    BugWarSledPrim.TransY = +16
  End If
End Sub

Dim BrainState
BrainState=False

Sub SolBrainFlash(Enabled)
  If Enabled Then
    BrainState=True
    BrainFrame=BrainFrame+1
  Else
    BrainState=False
    BrainFrame=BrainFrame-1
  End If
  EMReel1.SetValue BrainFrame
End Sub

Dim MON 'Motor On
Dim Position 'Bug Position
Dim Direction 'Moving forward/reverse
MON=0
Position=0
Direction=0

Sub SolMotorOn(Enabled)
  If Enabled Then
    MON=1
    Timer1.Enabled=0
    Timer1.Enabled=1
  Else
    MON=0
    Timer1.Enabled=0
  End If
End Sub

Sub Timer1_Timer
  If MON=1 Then
    If Direction=1 Then
      If BugLit=False Then
        If Position<5 Then
          BugWalls(Position).IsDropped=1
          BugTargets(Position).IsDropped=1
          Position=Position+1
          BugWalls(Position).IsDropped=0
          BugTargets(Position).IsDropped=0
          BugWarSledPrim.TransY=-32
        Else
          Direction=0
        End If
      Else
        If Position<11 Then
          BugWalls(Position).IsDropped=1
          BugTargets(Position).IsDropped=1
          Position=Position+1
          BugWalls(Position).IsDropped=0
          BugTargets(Position).IsDropped=0
          BugWarSledPrim.TransY=-32
        Else
          Direction=0
        End If
      End If
    Else
      If BugLit=False Then
        If Position>0 Then
          BugWalls(Position).IsDropped=1
          BugTargets(Position).IsDropped=1
          Position=Position-1
          BugWalls(Position).IsDropped=0
          BugTargets(Position).IsDropped=0
          BugWarSledPrim.TransY=+32
        Else
          Direction=1
        End If
      Else
        If Position>6 Then
          BugWalls(Position).IsDropped=1
          BugTargets(Position).IsDropped=1
          Position=Position-1
          BugWalls(Position).IsDropped=0
          BugTargets(Position).IsDropped=0
          BugWarSledPrim.TransY=+32
        Else
          Direction=1
        End If
      End If
    End If
    Select Case Position
      Case 0:Controller.Switch(33)=1
      Case 1:Controller.Switch(33)=0
      Case 4:Controller.Switch(34)=0
      Case 5:Controller.Switch(34)=1
      Case 6:Controller.Switch(33)=1
      Case 7:Controller.Switch(33)=0
      Case 10:Controller.Switch(34)=0
      Case 11:Controller.Switch(34)=1
    End Select
  End If
End Sub

Sub Sol25(Enabled)
  If Enabled Then
    FlasherLight8.State=LightStateOn
    FlasherLight1.State=LightStateOn
    FlasherLight12.State=LightStateOn
    FlasherLight16.State=LightStateOn
    'F1A.IsDropped=0
    'F1B.IsDropped=0
    'F1C.IsDropped=0
    'F1D.IsDropped=0
    PlaySound "Jon_GI_On"
  Else
    FlasherLight8.State=LightStateOff
    FlasherLight1.State=LightStateOff
    FlasherLight12.State=LightStateOff
    FlasherLight16.State=LightStateOff
    'F1A.IsDropped=1
    'F1B.IsDropped=1
    'F1C.IsDropped=1
    'F1D.IsDropped=1
    PlaySound "Jon_GI_Off"
  End If
End Sub

Sub Sol26(Enabled)
  If Enabled Then
    FlasherLight6.State=LightStateOn
    FlasherLight3.State=LightStateOn
    FlasherLight10.State=LightStateOn
    FlasherLight14.State=LightStateOn
    PlaySound "Jon_GI_On"
    'F2A.IsDropped=0
    'F2B.IsDropped=0
    'F2C.IsDropped=0
    'F2D.IsDropped=0
  Else
    FlasherLight6.State=LightStateOff
    FlasherLight3.State=LightStateOff
    FlasherLight10.State=LightStateOff
    FlasherLight14.State=LightStateOff
    'F2A.IsDropped=1
    'F2B.IsDropped=1
    'F2C.IsDropped=1
    'F2D.IsDropped=1
    PlaySound "Jon_GI_Off"
  End If
End Sub

Sub Sol27(Enabled)
  If Enabled Then
    FlasherLight7.State=LightStateOn
    FlasherLight2.State=LightStateOn
    FlasherLight11.State=LightStateOn
    FlasherLight15.State=LightStateOn
    'F3A.IsDropped=0
    'F3B.IsDropped=0
    'F3C.IsDropped=0
    'F3D.IsDropped=0
    PlaySound "Jon_GI_On"
  Else
    FlasherLight7.State=LightStateOff
    FlasherLight2.State=LightStateOff
    FlasherLight11.State=LightStateOff
    FlasherLight15.State=LightStateOff
    'F3A.IsDropped=1
    'F3B.IsDropped=1
    'F3C.IsDropped=1
    'F3D.IsDropped=1
    PlaySound "Jon_GI_Off"
  End If
End Sub

Sub Sol28(Enabled)
  If Enabled Then
    FlasherLight5.State=LightStateOn
    FlasherLight4.State=LightStateOn
    FlasherLight9.State=LightStateOn
    FlasherLight13.State=LightStateOn
    'F4A.IsDropped=0
    'F4B.IsDropped=0
    'F4C.IsDropped=0
    'F4D.IsDropped=0
    PlaySound "Jon_GI_On"
  Else
    FlasherLight5.State=LightStateOff
    FlasherLight4.State=LightStateOff
    FlasherLight9.State=LightStateOff
    FlasherLight13.State=LightStateOff
    'F4A.IsDropped=1
    'F4B.IsDropped=1
    'F4C.IsDropped=1
    'F4D.IsDropped=1
    PlaySound "Jon_GI_Off"
  End If
End Sub

Dim BrainE,BrainFrame
BrainE=False:BrainFrame=0

Sub SolBrainBug(Enabled)
  If Enabled Then
    EMReel1.TimerEnabled=0
    EMReel1.TimerEnabled=1
    Brain.IsDropped=0
    BrainBottom.IsDropped=0
    BrainE=True
    EMReel1_Timer
    pWorm.TransZ = +80
  Else
    EMReel1.TimerEnabled=0
    EMReel1.TimerEnabled=1
    BrainE=False
    EMReel1_Timer
    pWorm.TransZ = -80
  End If
End Sub

Sub EMReel1_Timer
  If BrainE=True Then
    If BrainFrame<4 Then
      BrainFrame=BrainFrame+2
    Else
      EMReel1.TimerEnabled=0
      Controller.Switch(37)=1
      Controller.Switch(39)=1
    End If
  Else
    If BrainFrame>1 Then
      BrainFrame=BrainFrame-2
    Else
      EMReel1.TimerEnabled=0
      Controller.Switch(37)=0
      Controller.Switch(39)=0
      Brain.IsDropped=1
      BrainBottom.IsDropped=1
    End If
  End If
  EMReel1.SetValue BrainFrame
End Sub

Sub Table1_KeyDown(ByVal KeyCode)
'  If KeyCode=LeftMagnaSave Then
  If KeyCode=RightMagnaSave Then Controller.Switch(88)=1
  If KeyCode=LeftFlipperKey Then Controller.Switch(63)=1
  If KeyCode=RightFlipperKey Then Controller.Switch(64)=1
  If KeyCode=PlungerKey Then Plunger.PullBack
  If KeyDownHandler(KeyCode) Then Exit Sub
End Sub

Sub Table1_KeyUp(ByVal KeyCode)
'  If KeyCode=LeftMagnaSave Then
  If KeyCode=RightMagnaSave Then Controller.Switch(88)=0
  If KeyCode=LeftFlipperKey Then Controller.Switch(63)=0
  If KeyCode=RightFlipperKey Then Controller.Switch(64)=0
  If KeyCode=PlungerKey Then Plunger.Fire
  If KeyUpHandler(KeyCode) Then Exit Sub
End Sub

ExtraKeyHelp=KeyUpperRight&vbTab&"Right Mini Flipper"

Dim bsTrough,bsBottom,bsTop,LMag,RMag,BugWalls,BugTargets
BugWalls=Array(Bug6,Bug5,Bug4,Bug3,Bug2,Bug1,Bug12,Bug11,Bug10,Bug9,Bug8,Bug7)
BugTargets=Array(BugT6,BugT5,BugT4,BugT3,BugT2,BugT1,BugT6,BugT5,BugT4,BugT3,BugT2,BugT1)

' Thalamus - Won't work with db2server it seems
'
'Sub SetDisplayToElement(Element)
'  If Controller.Version<="01500000" Then
'    ' forget it, version is to old
'    Exit Sub
'  End If
'  Dim playerRect
'  playerRect=Controller.GetClientRect(GetPlayerHwnd)
'  Dim playerWidth, playerHeight
'  playerWidth=playerRect(2)-playerRect(0)
'  playerHeight=playerRect(3)-playerRect(1)
'  Dim Game
'  Set Game=Controller.Game
'  Dim x,y
'  x=Element.x*playerWidth/1000.0-1
'  y=Element.y*playerHeight/750.0-1
'  Game.Settings.SetDisplayPosition x,y,GetPlayerHwnd
'  Set Game=nothing
'End Sub

Sub Table1_Init
  vpmInit me
  LeftGuide.IsDropped=1 'disables collision detection
  RightGuide.IsDropped=1 'disables collision detection
  FlasherLight1.State=LightStateOff
  FlasherLight2.State=LightStateOff
  FlasherLight3.State=LightStateOff
  FlasherLight4.State=LightStateOff
  FlasherLight5.State=LightStateOff
  FlasherLight6.State=LightStateOff
  FlasherLight7.State=LightStateOff
  FlasherLight8.State=LightStateOff
  FlasherLight9.State=LightStateOff
  FlasherLight10.State=LightStateOff
  FlasherLight11.State=LightStateOff
  FlasherLight12.State=LightStateOff
  FlasherLight13.State=LightStateOff
  FlasherLight14.State=LightStateOff
  FlasherLight15.State=LightStateOff
  FlasherLight16.State=LightStateOff
  D6L.IsDropped=1
  'F1A.IsDropped=1
  'F2A.IsDropped=1
  'F3A.IsDropped=1
  'F4A.IsDropped=1
  'F1B.IsDropped=1
  'F2B.IsDropped=1
  'F3B.IsDropped=1
  'F4B.IsDropped=1
  'F1C.IsDropped=1
  'F2C.IsDropped=1
  'F3C.IsDropped=1
  'F4C.IsDropped=1
  'F1D.IsDropped=1
  'F2D.IsDropped=1
  'F3D.IsDropped=1
  'F4D.IsDropped=1
  Brain.IsDropped=1
  BrainBottom.IsDropped=1
  Plunger1.PullBack
  BugT1.IsDropped=1
  BugT2.IsDropped=1
  BugT3.IsDropped=1
  BugT4.IsDropped=1
  BugT5.IsDropped=1
  Bug1.IsDropped=1
  Bug2.IsDropped=1
  Bug3.IsDropped=1
  Bug4.IsDropped=1
  Bug5.IsDropped=1
  Bug7.IsDropped=1
  Bug8.IsDropped=1
  Bug9.IsDropped=1
  Bug10.IsDropped=1
  Bug11.IsDropped=1
  Bug12.IsDropped=1
  WL1.IsDropped=1
  WL2.IsDropped=1
  WL3.IsDropped=1
  WL4.IsDropped=1
  WL5.IsDropped=1
  WL6.IsDropped=1
  WL56.IsDropped=1
  WL64.IsDropped=1
  Controller.GameName=cGameName
  Controller.SplashInfoLine="Starship Troopers"
  Controller.HandleKeyboard=0
  Controller.ShowTitle=0
  Controller.ShowDMDOnly=1
  Controller.ShowFrame=0
  ' On Error Resume Next
  ' SetDisplayToElement Textbox1
  Controller.Run GetPlayerHwnd
  If Err Then MsgBox Err.Description
  On Error Goto 0

  PinMAMETimer.Interval=PinMAMEInterval:PinMAMETimer.Enabled=1
  vpmNudge.TiltSwitch=56:vpmNudge.Sensitivity=5
  vpmNudge.TiltObj=Array(LeftSlingshot,RightSlingshot,Bumper1,Bumper2,Bumper3)

  Set bsTrough=New cvpmBallStack
  bsTrough.InitSw 0,15,14,13,12,0,0,0
  bsTrough.InitKick BallRelease,90,8
  bsTrough.InitExitSnd SoundFX("fx_ballRel",DOFContactors),SoundFX("SolOn",DOFContactors)
  bsTrough.Balls=4

  Set bsBottom=New cvpmBallStack
  bsBottom.InitSaucer VUK,45,120,10
  bsBottom.InitExitSnd SoundFX("Balleject",DOFContactors), SoundFX("SolOn",DOFContactors)

  Set bsTop=New cvpmBallStack
  bsTop.InitSw 0,46,0,0,0,0,0,0
  bsTop.InitKick VUKTop,180,10
  bsTop.InitExitSnd SoundFX("fx_ScoopExit",DOFContactors), SoundFX("SolOn",DOFContactors)

  Set LMag=New cvpmMagnet
  LMag.InitMagnet LMagnet,25
  LMag.GrabCenter=True

  Set RMag=New cvpmMagnet
  RMag.InitMagnet RMagnet,25
  LMag.GrabCenter=True

  Controller.Switch(33)=1 'Set Bug Mech to Home position
  vpmMapLights AllLights
End Sub

Dim Old44,Old45,Old23,Old24,New44,New45,New23,New24
Old44=0:Old45=0:Old23=0:Old24=0:New44=0:New45=0:New23=0:New24=0
Dim Old1,Old2,Old3,Old4,Old5,Old6,Old34,Old56,Old64
Dim New1,New2,New3,New4,New5,New6,New34,New56,New64
Old1=0:Old2=0:Old3=0:Old4=0:Old5=0:Old6=0:Old34=0:Old56=0:Old64=0
New1=0:New2=0:New3=0:New4=0:New5=0:New6=0:New34=0:New56=0:New64=0

Set LampCallback=GetRef("UpdateMultipleLamps")
Sub UpdateMultipleLamps
  New44=Controller.Lamp(44)
  New45=Controller.Lamp(45)
  New23=Controller.Lamp(23)
  New24=Controller.Lamp(24)
  If (New44<>Old44) Or (New45<>Old45) Or (New23<>Old23) Or (New24<>Old24) Then
    EMReel1.SetValue BrainFrame
    Old44=New44
    Old45=New45
    Old23=New23
    Old24=New24
  End If
  New1=Controller.Lamp(1)
  If New1<>Old1 Then
    If New1 Then
      WL1.IsDropped=0
    Else
      WL1.IsDropped=1
    End If
    Old1=New1
  End If
  New2=Controller.Lamp(2)
  If New2<>Old2 Then
    If New2 Then
      WL2.IsDropped=0
    Else
      WL2.IsDropped=1
    End If
    Old2=New2
  End If
  New3=Controller.Lamp(3)
  If New3<>Old3 Then
    If New3 Then
      WL3.IsDropped=0
    Else
      WL3.IsDropped=1
    End If
    Old3=New3
  End If
  New4=Controller.Lamp(4)
  If New4<>Old4 Then
    If New4 Then
      WL4.IsDropped=0
    Else
      WL4.IsDropped=1
    End If
    Old4=New4
  End If
  New5=Controller.Lamp(5)
  If New5<>Old5 Then
    If New5 Then
      WL5.IsDropped=0
    Else
      WL5.IsDropped=1
    End If
    Old5=New5
  End If
  New6=Controller.Lamp(6)
  If New6<>Old6 Then
    If New6 Then
      WL6.IsDropped=0
    Else
      WL6.IsDropped=1
    End If
    Old6=New6
  End If
  New34=Controller.Lamp(34)
  If New34<>Old34 Then
    If New34 Then
      D6L.IsDropped=0
    Else
      D6L.IsDropped=1
    End If
    Old34=New34
  End If
  New56=Controller.Lamp(56)
  If New56<>Old56 Then
    If New56 Then
      WL56.IsDropped=0
    Else
      WL56.IsDropped=1
    End If
    Old56=New56
  End If
  New64=Controller.Lamp(64)
  If New64<>Old64 Then
    If New64 Then
      WL64.IsDropped=0
    Else
      WL64.IsDropped=1
    End If
    Old64=New64
  End If
End Sub

Sub LMagnet_Hit:LMag.AddBall ActiveBall:End Sub
Sub LMagnet_UnHit:LMag.RemoveBall ActiveBall:End Sub
Sub RMagnet_Hit:RMag.AddBall ActiveBall:End Sub
Sub RMagnet_UnHit:RMag.RemoveBall ActiveBall:End Sub

Sub SS_Hit:SS.DestroyBall:vpmTimer.PulseSwitch 9,300,"ATV":End Sub    '9
Sub BK_Hit:BK.DestroyBall:vpmTimer.PulseSwitch 10,240,"ATV":End Sub   '10
Sub Drain_Hit:RandomSoundDrain:bsTrough.AddBall Me:End Sub                '12/13/14/15
Sub S16_Hit:Controller.Switch(16)=1:End Sub              '16
Sub S16_unHit:Controller.Switch(16)=0:End Sub
Sub T17_Hit:vpmTimer.PulseSw 17:End Sub                  '17
Sub T18_Hit:vpmTimer.PulseSw 18:End Sub                  '18
Sub T19_Hit:vpmTimer.PulseSw 19:End Sub                  '19
Sub T20_Hit:vpmTimer.PulseSw 20:End Sub                  '20
Sub T21_Hit:vpmTimer.PulseSw 21:End Sub                  '21
Sub T22_Hit:vpmTimer.PulseSw 22:End Sub                  '22
Sub T23_Hit:vpmTimer.PulseSw 23:End Sub                  '23
Sub T24_Hit:vpmTimer.PulseSw 24:End Sub                  '24
Sub S25_Hit:Controller.Switch(25)=1:End Sub              '25
Sub S25_unHit:Controller.Switch(25)=0:End Sub
Sub S26_Hit:Controller.Switch(26)=1:PlaySoundAtBall "WireRamp":End Sub              '26
Sub S26_unHit:Controller.Switch(26)=0:End Sub
Sub T27_Hit:vpmTimer.PulseSw 27:End Sub                  '27
Sub T28_Hit:vpmTimer.PulseSw 28:End Sub                  '28
Sub T29_Hit:vpmTimer.PulseSw 29:End Sub                  '29
Sub T30_Hit:vpmTimer.PulseSw 30:End Sub                  '30
Sub T31_Hit:vpmTimer.PulseSw 31:End Sub                  '31
Sub T32_Hit:vpmTimer.PulseSw 32:End Sub                  '32
Sub BugT1_Hit:vpmTimer.PulseSw 35:End Sub                '35
Sub BugT2_Hit:vpmTimer.PulseSw 35:End Sub
Sub BugT3_Hit:vpmTimer.PulseSw 35:End Sub
Sub BugT4_Hit:vpmTimer.PulseSw 35:End Sub
Sub BugT5_Hit:vpmTimer.PulseSw 35:End Sub
Sub BugT6_Hit:vpmTimer.PulseSw 35:End Sub
Sub Brain_Hit:vpmTimer.PulseSw 38:End Sub                '38
Sub PE_Hit:PE.DestroyBall:vpmTimer.PulseSwitch 40,100,"ATV":End Sub   '40
Sub ATV(swNo):bsTop.AddBall 0:End Sub
Sub S41_Hit:Controller.Switch(41)=1:End Sub              '41
Sub S41_unHit:Controller.Switch(41)=0:End Sub
Sub S42_Hit:Controller.Switch(42)=1:End Sub              '42
Sub S42_unHit:Controller.Switch(42)=0:End Sub
Sub S43_Hit:Controller.Switch(43)=1:End Sub              '43
Sub S43_unHit:Controller.Switch(43)=0:End Sub
Sub VUK_Hit:bsBottom.AddBall 0:End Sub                   '45
Sub VUKTop_Hit:bsTop.AddBall Me:End Sub                  '46
Sub S47_Hit:Controller.Switch(47)=1:End Sub              '47
Sub S47_unHit:Controller.Switch(47)=0:End Sub
Sub S48_Hit:Controller.Switch(48)=1:End Sub              '48
Sub S48_unHit:Controller.Switch(48)=0:End Sub
Sub Bumper1_Hit:vpmTimer.PulseSw 49:End Sub              '49
Sub Bumper2_Hit:vpmTimer.PulseSw 50:End Sub              '50
Sub Bumper3_Hit:vpmTimer.PulseSw 51:End Sub              '51
Sub S52_Hit:Controller.Switch(52)=1:End Sub              '52
Sub S52_unHit:Controller.Switch(52)=0:End Sub
Sub S53_Hit:Controller.Switch(53)=1:End Sub              '53
Sub S53_unHit:Controller.Switch(53)=0:End Sub
Sub S57_Hit:Controller.Switch(57)=1:End Sub              '57
Sub S57_unHit:Controller.Switch(57)=0:End Sub
Sub S58_Hit:Controller.Switch(58)=1:End Sub              '58
Sub S58_unHit:Controller.Switch(58)=0:End Sub
Sub LeftSlingshot_Slingshot:vpmTimer.PulseSw 59:End Sub  '59
Sub S60_Hit:Controller.Switch(60)=1:End Sub              '60
Sub S60_unHit:Controller.Switch(60)=0:End Sub
Sub S61_Hit:Controller.Switch(61)=1:End Sub              '61
Sub S61_unHit:Controller.Switch(61)=0:End Sub
Sub RightSlingshot_Slingshot:vpmTimer.PulseSw 62:End Sub '62

 Sub Trigger1_Hit:ActiveBall.VelZ=0:End Sub
 Sub Trigger2_Hit:ActiveBall.VelZ=0:End Sub

Sub Trigger001_Hit: StopSound "Wireramp" : End Sub
Sub Wall108_Hit : PlaySoundAtBallVol "RampEnd",.3 : End Sub

' *******************************************************************************************************
' Positional Sound Playback Functions by DJRobX, Rothbauerw and Herweh
' PlaySound sound, 0, Vol(ActiveBall), AudioPan(ActiveBall), 0, Pitch(ActiveBall), 0, 1, AudioFade(ActiveBall)
' *******************************************************************************************************

' Play a sound, depending on the X,Y position of the table element (especially cool for surround speaker setups, otherwise stereo panning only)
' parameters (defaults): loopcount (1), volume (1), randompitch (0), pitch (0), useexisting (0), restart (1))
' Note that this will not work (currently) for walls/slingshots as these do not feature a simple, single X,Y position

Sub PlayXYSound(soundname, tableobj, loopcount, volume, randompitch, pitch, useexisting, restart)
  PlaySound soundname, loopcount, volume, AudioPan(tableobj), randompitch, pitch, useexisting, restart, AudioFade(tableobj)
End Sub

' Set position as table object (Use object or light but NOT wall) and Vol to 1

Sub PlaySoundAt(soundname, tableobj)
  PlaySound soundname, 1, 1, AudioPan(tableobj), 0,0,0, 1, AudioFade(tableobj)
End Sub

' set position as table object and Vol + RndPitch manually

Sub PlaySoundAtVolPitch(sound, tableobj, Vol, RndPitch)
  PlaySound sound, 1, Vol, AudioPan(tableobj), RndPitch, 0, 0, 1, AudioFade(tableobj)
End Sub

'Set all as per ball position & speed.

Sub PlaySoundAtBall(soundname)
  PlaySoundAt soundname, ActiveBall
End Sub

'Set position as table object and Vol manually.

Sub PlaySoundAtVol(sound, tableobj, Volume)
  PlaySound sound, 1, Volume, AudioPan(tableobj), 0,0,0, 1, AudioFade(tableobj)
End Sub

'Set all as per ball position & speed, but Vol Multiplier may be used eg; PlaySoundAtBallVol "sound",3

Sub PlaySoundAtBallVol(sound, VolMult)
  PlaySound sound, 0, Vol(ActiveBall) * VolMult, AudioPan(ActiveBall), 0, Pitch(ActiveBall), 0, 1, AudioFade(ActiveBall)
End Sub

Sub PlaySoundAtBallAbsVol(sound, VolMult)
  PlaySound sound, 0, VolMult, AudioPan(ActiveBall), 0, Pitch(ActiveBall), 0, 1, AudioFade(ActiveBall)
End Sub

' requires rampbump1 to 7 in Sound Manager

Sub RandomBump(voladj, freq)
  Dim BumpSnd:BumpSnd= "rampbump" & CStr(Int(Rnd*7)+1)
  PlaySound BumpSnd, 0, Vol(ActiveBall)*voladj, AudioPan(ActiveBall), 0, freq, 0, 1, AudioFade(ActiveBall)
End Sub

' set position as bumperX and Vol manually. Allows rapid repetition/overlaying sound

Sub PlaySoundAtBumperVol(sound, tableobj, Vol)
  PlaySound sound, 1, Vol, AudioPan(tableobj), 0,0,1, 1, AudioFade(tableobj)
End Sub

Sub PlaySoundAtBOTBallZ(sound, BOT)
  PlaySound sound, 0, ABS(BOT.velz)/17, Pan(BOT), 0, Pitch(BOT), 1, 0, AudioFade(BOT)
End Sub

' play a looping sound at a location with volume
Sub PlayLoopSoundAtVol(sound, tableobj, Vol)
  PlaySound sound, -1, Vol, AudioPan(tableobj), 0, 0, 1, 0, AudioFade(tableobj)
End Sub

'*********************************************************************
'                     Supporting Ball & Sound Functions
'*********************************************************************

Function RndNum(min, max)
  RndNum = Int(Rnd() * (max-min + 1) ) + min ' Sets a random number between min and max
End Function

Function AudioFade(tableobj) ' Fades between front and back of the table (for surround systems or 2x2 speakers, etc), depending on the Y position on the table. "table1" is the name of the table
  Dim tmp
  On Error Resume Next
  tmp = tableobj.y * 2 / table1.height-1
  If tmp > 0 Then
    AudioFade = Csng(tmp ^10)
  Else
    AudioFade = Csng(-((- tmp) ^10) )
  End If
End Function

Function AudioPan(tableobj) ' Calculates the pan for a tableobj based on the X position on the table. "table1" is the name of the table
  Dim tmp
  On Error Resume Next
  tmp = tableobj.x * 2 / table1.width-1
  If tmp > 0 Then
    AudioPan = Csng(tmp ^10)
  Else
    AudioPan = Csng(-((- tmp) ^10) )
  End If
End Function

Function Pan(ball) ' Calculates the pan for a ball based on the X position on the table. "table1" is the name of the table
  Dim tmp
  On Error Resume Next
  tmp = ball.x * 2 / table1.width-1
  If tmp > 0 Then
    Pan = Csng(tmp ^10)
  Else
    Pan = Csng(-((- tmp) ^10) )
  End If
End Function

Function Vol(ball) ' Calculates the Volume of the sound based on the ball speed
  Vol = Csng(BallVel(ball) ^2 / VolDiv)
End Function

Function BallRollVol(ball) ' Calculates the Volume of the sound based on the ball speed
  BallRollVol = Csng(BallVel(ball) ^2 / (80000 - (79900 * Log(RollVol) / Log(100))))
End Function

Function Pitch(ball) ' Calculates the pitch of the sound based on the ball speed
  Pitch = BallVel(ball) * 20
End Function

Function BallVel(ball) 'Calculates the ball speed
  BallVel = INT(SQR((ball.VelX ^2) + (ball.VelY ^2) ) )
End Function

Function BallVelZ(ball) 'Calculates the ball speed in the -Z
  BallVelZ = INT((ball.VelZ) * -1 )
End Function

Function VolZ(ball) ' Calculates the Volume of the sound based on the ball speed in the Z
  VolZ = Csng(BallVelZ(ball) ^2 / 200)*1.2
End Function

'*** Determines if a Points (px,py) is inside a 4 point polygon A-D in Clockwise/CCW order

Function InRect(px,py,ax,ay,bx,by,cx,cy,dx,dy)
  Dim AB, BC, CD, DA
  AB = (bx*py) - (by*px) - (ax*py) + (ay*px) + (ax*by) - (ay*bx)
  BC = (cx*py) - (cy*px) - (bx*py) + (by*px) + (bx*cy) - (by*cx)
  CD = (dx*py) - (dy*px) - (cx*py) + (cy*px) + (cx*dy) - (cy*dx)
  DA = (ax*py) - (ay*px) - (dx*py) + (dy*px) + (dx*ay) - (dy*ax)

  If (AB <= 0 AND BC <=0 AND CD <= 0 AND DA <= 0) Or (AB >= 0 AND BC >=0 AND CD >= 0 AND DA >= 0) Then
    InRect = True
  Else
    InRect = False
  End If
End Function


'*****************************************
'      JP's VP10 Rolling Sounds
'*****************************************

Const tnob = 5 ' total number of balls
ReDim rolling(tnob)
InitRolling

Sub InitRolling
    Dim i
    For i = 0 to tnob
        rolling(i) = False
    Next
End Sub

Sub RollingTimer_Timer()
    Dim BOT, b
    BOT = GetBalls

  ' stop the sound of deleted balls
    For b = UBound(BOT) + 1 to tnob
        rolling(b) = False
        StopSound("fx_ballrolling" & b)
    Next

  ' exit the sub if no balls on the table
    If UBound(BOT) = -1 Then Exit Sub

  ' play the rolling sound for each ball

    For b = 0 to UBound(BOT)
      If BallVel(BOT(b) ) > 1 Then
        rolling(b) = True
        if BOT(b).z < 30 Then ' Ball on playfield
          PlaySound("fx_ballrolling" & b), -1, Vol(BOT(b) ), AudioPan(BOT(b) ), 0, Pitch(BOT(b) ), 1, 0, AudioFade(BOT(b) )
          ' PlaySound("fx_ballrolling" & b), -1, BallRollVol(BOT(b) )*.8, AudioPan(BOT(b) ), 0, Pitch(BOT(b) ), 1, 0, AudioFade(BOT(b) )
        Else ' Ball on raised ramp
          PlaySound("fx_ballrolling" & b), -1, Vol(BOT(b) )*.5, AudioPan(BOT(b) ), 0, Pitch(BOT(b) )+50000, 1, 0, AudioFade(BOT(b) )
          ' PlaySound("fx_ballrolling" & b), -1, BallRollVol(BOT(b) )*.2, AudioPan(BOT(b) ), 0, Pitch(BOT(b) )+50000, 1, 0, AudioFade(BOT(b) )
        End If
      Else
        If rolling(b) = True Then
          StopSound("fx_ballrolling" & b)
          rolling(b) = False
        End If
      End If
    If BOT(b).VelZ < -1 and BOT(b).z < 55 and BOT(b).z > 27 Then 'height adjust for ball drop sounds
      PlaySoundAtBOTBallZ "fx_ball_drop" & b, BOT(b)
    End If
    Next
End Sub

'**********************
' Ball Collision Sound
'**********************

Sub OnBallBallCollision(ball1, ball2, velocity)
    PlaySound("fx_collide"), 0, Csng(velocity) ^2 / (VolDiv/VolCol), AudioPan(ball1), 0, Pitch(ball1), 0, 0, AudioFade(ball1)
End Sub

'Missing Motor Sound


'**************************************
' Explanation of the collision routine
'**************************************

' The collision is built in VP.
' You only need to add a Sub OnBallBallCollision(ball1, ball2, velocity) and when two balls collide they 
' will call this routine. What you add in the sub is up to you. As an example is a simple Playsound with volume and paning
' depending of the speed of the collision.

Sub Pins_Hit (idx)
	PlaySound "pinhit_low", 0, Vol(ActiveBall), AudioPan(ActiveBall), 0, Pitch(ActiveBall), 0, 0, AudioFade(ActiveBall)
End Sub

Sub Rollovers_Hit (idx)
	' PlaySound "pinhit_low", 0, Vol(ActiveBall), AudioPan(ActiveBall), 0, Pitch(ActiveBall), 0, 0, AudioFade(ActiveBall)
  RandomSoundRollover()
End Sub

Sub Targets_Hit (idx)
	' PlaySound "target", 0, Vol(ActiveBall), AudioPan(ActiveBall), 0, Pitch(ActiveBall), 0, 0, AudioFade(ActiveBall)
  RandomSoundTargetHitStrong()
End Sub

Sub Metals_Thin_Hit (idx)
	' PlaySound "metalhit_thin", 0, Vol(ActiveBall), AudioPan(ActiveBall), 0, Pitch(ActiveBall), 1, 0, AudioFade(ActiveBall)
  RandomSoundMetal
End Sub

Sub Metals_Medium_Hit (idx)
	' PlaySound "metalhit_medium", 0, Vol(ActiveBall), AudioPan(ActiveBall), 0, Pitch(ActiveBall), 1, 0, AudioFade(ActiveBall)
  RandomSoundMetal
End Sub

Sub Metals2_Hit (idx)
	' PlaySound "metalhit2", 0, Vol(ActiveBall), AudioPan(ActiveBall), 0, Pitch(ActiveBall), 1, 0, AudioFade(ActiveBall)
  RandomSoundMetal()
End Sub

Sub Gates_Hit (idx)
	PlaySound "gate4", 0, Vol(ActiveBall), AudioPan(ActiveBall), 0, Pitch(ActiveBall), 1, 0, AudioFade(ActiveBall)
End Sub

Sub Spinner_Spin
	PlaySound "fx_spinner", 0, 1, AudioPan(Spinner), 0.25, 0, 0, 1, AudioFade(Spinner)
End Sub

Sub Rubbers_Hit(idx)
  dim finalspeed
    finalspeed=SQR(activeball.velx * activeball.velx + activeball.vely * activeball.vely)
  If finalspeed > 5 then
    RandomSoundRubberStrong()
  End if
  If finalspeed <= 5 then
    RandomSoundRubberWeak()
  End If
End Sub

Sub Posts_Hit(idx)
  dim finalspeed
    finalspeed=SQR(activeball.velx * activeball.velx + activeball.vely * activeball.vely)
  If finalspeed > 5 then
    RandomSoundRubberStrong()
  End if
  If finalspeed <= 5 then
    RandomSoundRubberWeak()
  End If
End Sub

Sub RandomSoundRubberStrong()
  Select Case Int(Rnd*10)+1
    Case 1 : PlaySoundAtVol "TOM_Rubber_Flipper_Slingshot_Strong_1", ActiveBall, VolRH
    Case 2 : PlaySoundAtVol "TOM_Rubber_Flipper_Slingshot_Strong_2", ActiveBall, VolRH
    Case 3 : PlaySoundAtVol "TOM_Rubber_Flipper_Slingshot_Strong_3", ActiveBall, VolRH
    Case 4 : PlaySoundAtVol "TOM_Rubber_Flipper_Slingshot_Strong_4", ActiveBall, VolRH
    Case 5 : PlaySoundAtVol "TOM_Rubber_Flipper_Slingshot_Strong_5", ActiveBall, VolRH
    Case 6 : PlaySoundAtVol "TOM_Rubber_Flipper_Slingshot_Strong_6", ActiveBall, VolRH
    Case 7 : PlaySoundAtVol "TOM_Rubber_Flipper_Slingshot_Strong_7", ActiveBall, VolRH
    Case 8 : PlaySoundAtVol "TOM_Rubber_Flipper_Slingshot_Strong_8", ActiveBall, VolRH
    Case 9 : PlaySoundAtVol "TOM_Rubber_Flipper_Slingshot_Strong_9", ActiveBall, VolRH
    Case 10 : PlaySoundAtVol "TOM_Rubber_1_Hard", ActiveBall, VolRH
  End Select
End Sub

Sub RandomSoundRubberWeak()
  Select Case Int(Rnd*9)+1
    Case 1 : PlaySoundAtVol "TOM_Rubber_1", ActiveBall, VolRH * 0.5
    Case 2 : PlaySoundAtVol "TOM_Rubber_2", ActiveBall, VolRH * 0.5
    Case 3 : PlaySoundAtVol "TOM_Rubber_3", ActiveBall, VolRH * 0.5
    Case 4 : PlaySoundAtVol "TOM_Rubber_3", ActiveBall, VolRH * 0.5
    Case 5 : PlaySoundAtVol "TOM_Rubber_5", ActiveBall, VolRH * 0.5
    Case 6 : PlaySoundAtVol "TOM_Rubber_6", ActiveBall, VolRH * 0.5
    Case 7 : PlaySoundAtVol "TOM_Rubber_7", ActiveBall, VolRH * 0.5
    Case 8 : PlaySoundAtVol "TOM_Rubber_8", ActiveBall, VolRH * 0.5
    Case 9 : PlaySoundAtVol "TOM_Rubber_9", ActiveBall, VolRH * 0.5
  End Select
End Sub

Sub LeftFlipper_Collide(parm)
 	'RandomSoundFlipper()
  RandomSoundFlipper()
End Sub

Sub RightFlipper_Collide(parm)
 	'RandomSoundFlipper()
  RandomSoundFlipper()
End Sub

Sub RandomSoundFlipper()
	Select Case Int(Rnd*3)+1
		Case 1 : PlaySound "flip_hit_1", 0, Vol(ActiveBall), AudioPan(ActiveBall), 0, Pitch(ActiveBall), 1, 0, AudioFade(ActiveBall)
		Case 2 : PlaySound "flip_hit_2", 0, Vol(ActiveBall), AudioPan(ActiveBall), 0, Pitch(ActiveBall), 1, 0, AudioFade(ActiveBall)
		Case 3 : PlaySound "flip_hit_3", 0, Vol(ActiveBall), AudioPan(ActiveBall), 0, Pitch(ActiveBall), 1, 0, AudioFade(ActiveBall)
	End Select
End Sub

Sub RandomSoundRubberFlipper(parm)
  Select Case Int(Rnd*7)+1
    Case 1 : PlaySoundAtBallVol "TOM_Rubber_Flipper_Normal_1", parm, VolFlipH
    Case 2 : PlaySoundAtBallVol "TOM_Rubber_Flipper_Normal_2", parm, VolFlipH
    Case 3 : PlaySoundAtBallVol "TOM_Rubber_Flipper_Normal_3", parm, VolFlipH
    Case 4 : PlaySoundAtBallVol "TOM_Rubber_Flipper_Normal_4", parm, VolFlipH
    Case 5 : PlaySoundAtBallVol "TOM_Rubber_Flipper_Normal_5", parm, VolFlipH
    Case 6 : PlaySoundAtBallVol "TOM_Rubber_Flipper_Normal_6", parm, VolFlipH
    Case 7 : PlaySoundAtBallVol "TOM_Rubber_Flipper_Normal_7", parm, VolFlipH
  End Select
End Sub

Sub RandomSoundMetal()
  Select Case Int(Rnd*13)+1
    Case 1 : PlaySoundAtVol "TOM_Metal_Touch_1", ActiveBall, VolMetal
    Case 2 : PlaySoundAtVol "TOM_Metal_Touch_2", ActiveBall, VolMetal
    Case 3 : PlaySoundAtVol "TOM_Metal_Touch_3", ActiveBall, VolMetal
    Case 4 : PlaySoundAtVol "TOM_Metal_Touch_4", ActiveBall, VolMetal
    Case 5 : PlaySoundAtVol "TOM_Metal_Touch_5", ActiveBall, VolMetal
    Case 6 : PlaySoundAtVol "TOM_Metal_Touch_6", ActiveBall, VolMetal
    Case 7 : PlaySoundAtVol "TOM_Metal_Touch_7", ActiveBall, VolMetal
    Case 8 : PlaySoundAtVol "TOM_Metal_Touch_8", ActiveBall, VolMetal
    Case 9 : PlaySoundAtVol "TOM_Metal_Touch_9", ActiveBall, VolMetal
    Case 10 : PlaySoundAtVol "TOM_Metal_Touch_10", ActiveBall, VolMetal
    Case 11 : PlaySoundAtVol "TOM_Metal_Touch_11", ActiveBall, VolMetal
    Case 12 : PlaySoundAtVol "TOM_Metal_Touch_12", ActiveBall, VolMetal
    Case 13 : PlaySoundAtVol "TOM_Metal_Touch_13", ActiveBall, VolMetal
  End Select
End Sub

Sub RandomSoundRollover()
  Select Case Int(Rnd*4)+1
    Case 1 : PlaySoundAtVol "TOM_Rollover_1", ActiveBall, VolRol
    Case 2 : PlaySoundAtVol "TOM_Rollover_2", ActiveBall, VolRol
    Case 3 : PlaySoundAtVol "TOM_Rollover_3", ActiveBall, VolRol
    Case 4 : PlaySoundAtVol "TOM_Rollover_4", ActiveBall, VolRol
  End Select
End Sub

Sub RandomSoundTargetHitStrong()
  Select Case Int(Rnd*4)+1
    Case 1 : PlaySoundAtVol SoundFX("TOM_Target_Hit_5",DOFTargets), ActiveBall, VolTarg
    Case 2 : PlaySoundAtVol SoundFX("TOM_Target_Hit_6",DOFTargets), ActiveBall, VolTarg
    Case 3 : PlaySoundAtVol SoundFX("TOM_Target_Hit_7",DOFTargets), ActiveBall, VolTarg
    Case 4 : PlaySoundAtVol SoundFX("TOM_Target_Hit_8",DOFTargets), ActiveBall, VolTarg
  End Select
End Sub

Sub RandomSoundTargetHitWeak()
  Select Case Int(Rnd*4)+1
    Case 1 : PlaySoundAtVol SoundFX("TOM_Target_Hit_1",DOFTargets), ActiveBall, VolTarg
    Case 2 : PlaySoundAtVol SoundFX("TOM_Target_Hit_2",DOFTargets), ActiveBall, VolTarg
    Case 3 : PlaySoundAtVol SoundFX("TOM_Target_Hit_3",DOFTargets), ActiveBall, VolTarg
    Case 4 : PlaySoundAtVol SoundFX("TOM_Target_Hit_4",DOFTargets), ActiveBall, VolTarg
  End Select
End Sub

Sub RandomSoundDrain()
  Select Case Int(Rnd*11)+1
    Case 1 : PlaySoundAtVol ("TOM_Drain_1"), Drain, VolDrain
    Case 2 : PlaySoundAtVol ("TOM_Drain_2"), Drain, VolDrain
    Case 3 : PlaySoundAtVol ("TOM_Drain_3"), Drain, VolDrain
    Case 4 : PlaySoundAtVol ("TOM_Drain_4"), Drain, VolDrain
    Case 5 : PlaySoundAtVol ("TOM_Drain_5"), Drain, VolDrain
    Case 6 : PlaySoundAtVol ("TOM_Drain_6"), Drain, VolDrain
    Case 7 : PlaySoundAtVol ("TOM_Drain_7"), Drain, VolDrain
    Case 8 : PlaySoundAtVol ("TOM_Drain_8"), Drain, VolDrain
    Case 9 : PlaySoundAtVol ("TOM_Drain_9"), Drain, VolDrain
    Case 10 : PlaySoundAtVol ("TOM_Drain_10"), Drain, VolDrain
    Case 11 : PlaySoundAtVol ("TOM_Drain_10"), Drain, VolDrain
  End Select
End Sub